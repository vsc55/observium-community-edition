<?php
/**
 * Observium
 *
 *   This file is part of Observium.
 *
 * @package    observium
 * @subpackage poller
 * @copyright  (C) 2006-2013 Adam Armstrong, (C) 2013-2025 Observium Limited
 *
 */

echo(' ACD-TWAMP-GEN-MIB ');

// Active Stats

// ACD-TWAMP-GEN-MIB::acdTwampGenResultTwoWayDelayValid.1 = INTEGER: true(1)
// ACD-TWAMP-GEN-MIB::acdTwampGenResultTwoWayDelayInstValue.1 = INTEGER: 110
// ACD-TWAMP-GEN-MIB::acdTwampGenResultTwoWayDelayCurrSamples.1 = Gauge32: 714
// ACD-TWAMP-GEN-MIB::acdTwampGenResultTwoWayDelayCurrMinValue.1 = INTEGER: 57
// ACD-TWAMP-GEN-MIB::acdTwampGenResultTwoWayDelayCurrMaxValue.1 = INTEGER: 134
// ACD-TWAMP-GEN-MIB::acdTwampGenResultTwoWayDelayCurrAvgValue.1 = INTEGER: 98
// ACD-TWAMP-GEN-MIB::acdTwampGenResultTwoWayDelayCurrThreshEx.1 = Gauge32: 0

// ACD-TWAMP-GEN-MIB::acdTwampGenResultTwoWayDvValid.1 = INTEGER: true(1)
// ACD-TWAMP-GEN-MIB::acdTwampGenResultTwoWayDvInstValue.1 = INTEGER: 10
// ACD-TWAMP-GEN-MIB::acdTwampGenResultTwoWayDvCurrSamples.1 = Gauge32: 714
// ACD-TWAMP-GEN-MIB::acdTwampGenResultTwoWayDvCurrMinValue.1 = INTEGER: 0
// ACD-TWAMP-GEN-MIB::acdTwampGenResultTwoWayDvCurrMaxValue.1 = INTEGER: 65
// ACD-TWAMP-GEN-MIB::acdTwampGenResultTwoWayDvCurrAvgValue.1 = INTEGER: 19
// ACD-TWAMP-GEN-MIB::acdTwampGenResultTwoWayDvCurrThreshEx.1 = Gauge32: 0

// ACD-TWAMP-GEN-MIB::acdTwampGenResultOneWayNeDelayValid.1 = INTEGER: false(2)
// ACD-TWAMP-GEN-MIB::acdTwampGenResultOneWayNeDelayInstValue.1 = INTEGER: 0
// ACD-TWAMP-GEN-MIB::acdTwampGenResultOneWayNeDelayCurrSamples.1 = Gauge32: 0
// ACD-TWAMP-GEN-MIB::acdTwampGenResultOneWayNeDelayCurrMinValue.1 = INTEGER: -1
// ACD-TWAMP-GEN-MIB::acdTwampGenResultOneWayNeDelayCurrMaxValue.1 = INTEGER: 0
// ACD-TWAMP-GEN-MIB::acdTwampGenResultOneWayNeDelayCurrAvgValue.1 = INTEGER: 0
// ACD-TWAMP-GEN-MIB::acdTwampGenResultOneWayNeDelayCurrThreshEx.1 = Gauge32: 0

// ACD-TWAMP-GEN-MIB::acdTwampGenResultOneWayNeDvValid.1 = INTEGER: false(2)
// ACD-TWAMP-GEN-MIB::acdTwampGenResultOneWayNeDvInstValue.1 = INTEGER: 0
// ACD-TWAMP-GEN-MIB::acdTwampGenResultOneWayNeDvCurrSamples.1 = Gauge32: 0
// ACD-TWAMP-GEN-MIB::acdTwampGenResultOneWayNeDvCurrMinValue.1 = INTEGER: -1
// ACD-TWAMP-GEN-MIB::acdTwampGenResultOneWayNeDvCurrMaxValue.1 = INTEGER: 0
// ACD-TWAMP-GEN-MIB::acdTwampGenResultOneWayNeDvCurrAvgValue.1 = INTEGER: 0
// ACD-TWAMP-GEN-MIB::acdTwampGenResultOneWayNeDvCurrThreshEx.1 = Gauge32: 0

// ACD-TWAMP-GEN-MIB::acdTwampGenResultOneWayFeDelayValid.1 = INTEGER: false(2)
// ACD-TWAMP-GEN-MIB::acdTwampGenResultOneWayFeDelayInstValue.1 = INTEGER: 0
// ACD-TWAMP-GEN-MIB::acdTwampGenResultOneWayFeDelayCurrSamples.1 = Gauge32: 0
// ACD-TWAMP-GEN-MIB::acdTwampGenResultOneWayFeDelayCurrMinValue.1 = INTEGER: -1
// ACD-TWAMP-GEN-MIB::acdTwampGenResultOneWayFeDelayCurrMaxValue.1 = INTEGER: 0
// ACD-TWAMP-GEN-MIB::acdTwampGenResultOneWayFeDelayCurrAvgValue.1 = INTEGER: 0
// ACD-TWAMP-GEN-MIB::acdTwampGenResultOneWayFeDelayCurrThreshEx.1 = Gauge32: 0

// ACD-TWAMP-GEN-MIB::acdTwampGenResultOneWayFeDvValid.1 = INTEGER: false(2)
// ACD-TWAMP-GEN-MIB::acdTwampGenResultOneWayFeDvInstValue.1 = INTEGER: 0
// ACD-TWAMP-GEN-MIB::acdTwampGenResultOneWayFeDvCurrSamples.1 = Gauge32: 0
// ACD-TWAMP-GEN-MIB::acdTwampGenResultOneWayFeDvCurrMinValue.1 = INTEGER: -1
// ACD-TWAMP-GEN-MIB::acdTwampGenResultOneWayFeDvCurrMaxValue.1 = INTEGER: 0
// ACD-TWAMP-GEN-MIB::acdTwampGenResultOneWayFeDvCurrAvgValue.1 = INTEGER: 0
// ACD-TWAMP-GEN-MIB::acdTwampGenResultOneWayFeDvCurrThreshEx.1 = Gauge32: 0

// ACD-TWAMP-GEN-MIB::acdTwampGenResultPktLossCurrSamples.1 = Gauge32: 714
// ACD-TWAMP-GEN-MIB::acdTwampGenResultPktLossCurrLostPackets.1 = Gauge32: 0
// ACD-TWAMP-GEN-MIB::acdTwampGenResultPktLossCurrLossRatio.1 = Gauge32: 0
// ACD-TWAMP-GEN-MIB::acdTwampGenResultPktLossCurrOutOfOrder.1 = Gauge32: 0
// ACD-TWAMP-GEN-MIB::acdTwampGenResultPktLossCurrDuplicate.1 = Gauge32: 0
// ACD-TWAMP-GEN-MIB::acdTwampGenResultPktLossCurrGaps.1 = Gauge32: 0
// ACD-TWAMP-GEN-MIB::acdTwampGenResultPktLossCurrLargestGap.1 = Gauge32: 0

//$sla_poll = snmpwalk_cache_oid($device, "acdTwampGenResultTable", [], 'ACD-TWAMP-GEN-MIB');
$sla_poll = snmpwalk_cache_oid($device, "acdTwampGenResultTwoWayDelayValid",               [], 'ACD-TWAMP-GEN-MIB');
$sla_poll = snmpwalk_cache_oid($device, "acdTwampGenResultTwoWayDelayInstValue",    $sla_poll, 'ACD-TWAMP-GEN-MIB');
$sla_poll = snmpwalk_cache_oid($device, "acdTwampGenResultTwoWayDelayCurrSamples",  $sla_poll, 'ACD-TWAMP-GEN-MIB');
$sla_poll = snmpwalk_cache_oid($device, "acdTwampGenResultTwoWayDelayCurrMinValue", $sla_poll, 'ACD-TWAMP-GEN-MIB');
$sla_poll = snmpwalk_cache_oid($device, "acdTwampGenResultTwoWayDelayCurrMaxValue", $sla_poll, 'ACD-TWAMP-GEN-MIB');
$sla_poll = snmpwalk_cache_oid($device, "acdTwampGenResultTwoWayDelayCurrAvgValue", $sla_poll, 'ACD-TWAMP-GEN-MIB');
//$sla_poll = snmpwalk_cache_oid($device, "acdTwampGenResultTwoWayDelayCurrThreshEx", $sla_poll, 'ACD-TWAMP-GEN-MIB');

$sla_poll = snmpwalk_cache_oid($device, "acdTwampGenResultPktLossCurrLostPackets",  $sla_poll, 'ACD-TWAMP-GEN-MIB');
//$sla_poll = snmpwalk_cache_oid($device, "acdTwampGenResultPktLossCurrLossRatio",    $sla_poll, 'ACD-TWAMP-GEN-MIB');
$sla_endtime = round(snmp_endtime());
//print_debug_vars($sla_poll);

foreach ($sla_poll as $sla_index => $entry) {
    // SLA event
    $sla_array = get_state_array('acdTwampGenResultValid', $entry['acdTwampGenResultTwoWayDelayValid'], 'ACD-TWAMP-GEN-MIB');

    $sla_state = [
        'rtt_value'    => $entry['acdTwampGenResultTwoWayDelayInstValue'],
        'rtt_sense'    => $entry['acdTwampGenResultTwoWayDelayValid'],
        'rtt_unixtime' => $sla_endtime,
        'rtt_event'    => $sla_array['event'],
        // jitter
        'rtt_minimum' => $entry['acdTwampGenResultTwoWayDelayCurrMinValue'],
        'rtt_maximum' => $entry['acdTwampGenResultTwoWayDelayCurrMaxValue'],
        'rtt_success' => $entry['acdTwampGenResultTwoWayDelayCurrSamples'] - $entry['acdTwampGenResultPktLossCurrLostPackets'],
        'rtt_loss'    => $entry['acdTwampGenResultPktLossCurrLostPackets']
    ];

    $cache_sla[$mib_lower][$sla_index] = $sla_state;
}

// EOF
